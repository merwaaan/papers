\documentclass{article}

\usepackage[utf8]{inputenc}
\usepackage[francais]{babel}
\usepackage{amsmath}
\usepackage{tikz}
\usepackage{float}

\usetikzlibrary{calc}

\title{Algèbre de chemins}
\author{Merwan Achibet\\Université du Havre}
\date{}

\begin{document}

\newcommand{\mmin}{\ensuremath{\operatorname{min}}}
\newcommand{\mmax}{\ensuremath{\operatorname{max}}}
\newcommand{\mMAX}{\ensuremath{\operatorname{MAX}}}
\newcommand{\msi}{\ensuremath{\operatorname{si}}}
\newcommand{\malors}{\ensuremath{\operatorname{alors}}}

\maketitle

\section{Montrer que $(R^+, \mmax, \mmin, 0,
  \infty)$ est un semi-anneau idempotent}

On veut démontrer que $(R^+, \mmax, \mmin, 0, \infty)$ est un
semi-anneau idempotent. Pour ce faire, on doit prouver que :

\begin{enumerate}
  \item{$(R^+, \mmax, 0)$ est un monoïde commutatif}
  \item{$(R^+, \mmin, \infty)$ est un monoïde}
  \item{l'opération $\mmin$ est distributive par rapport à $\mmax$}
  \item{l'élément $0$ est absorbant pour l'opération $\mmin$}
\end{enumerate}

Pour chacune des quatre démonstrations qui suivent, on prend $a, b, c \in R^+$.

\subsection{$(R^+, \mmax, 0)$ est un monoïde commutatif}

$$ \mmax(a, b) = \mmax(b, a)$$
\begin{center}et\end{center}
$$ \mmax(a, 0) = \mmax(0, a) = a $$\\

$(R^+, \mmax, 0)$ est donc un monoïde commutatif.

\subsection{$(R^+, \mmin, \infty)$ est un monoïde}

$$ \mmin(a, \infty) = \mmin(\infty, a) = a$$\\

$(R^+, \mmin, \infty)$ est donc un monoïde.

\subsection{l'opération $\mmin$ est distributive par rapport à $\mmax$}

Pour que cette opération soit distributive, il faut que :

$$\mmin(a, \mmax(b,c)) = \mmax(\mmin(a,b),\mmin(a,c))$$
\begin{center}et\end{center}
$$\mmin(\mmax(a,b),c) = \mmax(\mmin(a,c),\mmin(a,b))$$\\

On étudie les six cas de figure possibles.

\subsubsection{$a \geq b \geq c$}

$$\mmin(a, \mmax(b, c)) = \mmin(a, b) = b = \mmax(b,c) = \mmax(\mmin(a, b),\mmin(a,c))$$
\begin{center}et\end{center}
$$\mmin(\mmax(a,b),c) = \mmin(a,c) = c = \mmax(c,c) = \mmax(\mmin(a,c),\mmin(b,c))$$

\subsubsection{$a \geq c \geq b$}

$$\mmin(a, \mmax(b, c)) = \mmin(a, c) = c = \mmax(b,c) = \mmax(\mmin(a, b),\mmin(a,c))$$
\begin{center}et\end{center}
$$\mmin(\mmax(a,b),c) = \mmin(a,c) = c = \mmax(c,c) = \mmax(\mmin(a,c),\mmin(b,c))$$

\subsubsection{$b \geq a \geq c$}

$$\mmin(a, \mmax(b, c)) = \mmin(a, b) = a = \mmax(a,c) = \mmax(\mmin(a, b),\mmin(a,c))$$
\begin{center}et\end{center}
$$\mmin(\mmax(a,b),c) = \mmin(b,c) = c = \mmax(c,c) = \mmax(\mmin(a,c),\mmin(b,c))$$

\subsubsection{$b \geq c \geq a$}

$$\mmin(a, \mmax(b, c)) = \mmin(a, b) = a = \mmax(a,a) = \mmax(\mmin(a, b),\mmin(a,c))$$
\begin{center}et\end{center}
$$\mmin(\mmax(a,b),c) = \mmin(b,c) = c = \mmax(a,c) = \mmax(\mmin(a,c),\mmin(b,c))$$

\subsubsection{$c \geq a \geq b$}

$$\mmin(a, \mmax(b, c)) = \mmin(a,c) = a = \mmax(b,a) = \mmax(\mmin(a, b),\mmin(a,c))$$
\begin{center}et\end{center}
$$\mmin(\mmax(a,b),c) = \mmin(a,c) = a = \mmax(a,b) = \mmax(\mmin(a,c),\mmin(b,c))$$

\subsubsection{$c \geq b \geq a$}

$$\mmin(a, \mmax(b, c)) = \mmin(a,c) = a = \mmax(a,a) = \mmax(\mmin(a, b),\mmin(a,c))$$
\begin{center}et\end{center}
$$\mmin(\mmax(a,b),c) = \mmin(b,c) = b = \mmax(a,b) = \mmax(\mmin(a,c),\mmin(b,c))$$\\

Chaque cas de figure est vérifié, \mmin\; est donc distributive par rapport à \mmax.

\subsection{l'élément  $0$ est absorbant pour l'opération $\mmin$}

$$ \mmin(a,0) = \mmin(0,a) = 0$$\\

L'élément $0$ est donc absorbant pour $\mmin$.\\

Les quatres conditions précedemment citées sont validées, $(R^+,
\mmax, \mmin, 0, \infty)$ est donc un semi-anneau idempotent.

\subsection{Matrice d'adjacence}

La matrice d'adjacence est la suivante. On considère dans le cadre de
ce problème que pour tout $i \in \{1,\dots,8\}$, $A_{ii} = \infty$.\\

$$
A = \bordermatrix{
    & 1 & 2 & 3 & 4 & 5 & 6 & 7 & 8 \cr
  1 & \infty & 12 & 14 & 10 & 0 & 0 & 0 & 0 \cr
  2 & 12 & \infty & 0 & 17 & 8 & 0 & 0 & 0 \cr
  3 & 14 & 0 & \infty & 5 & 0 & 3 & 0 & 0 \cr
  4 & 10 & 17 & 5 & \infty & 11 & 6 & 15 & 0 \cr
  5 & 0 & 8 & 0 & 11 & \infty & 0 & 18 & 11 \cr
  6 & 0 & 0 & 3 & 6 & 0 & \infty & 4 & 15 \cr
  7 & 0 & 0 & 0 & 15 & 18 & 4 & \infty & 9 \cr
  8 & 0 & 0 & 0 & 0 & 11 & 15 & 9 & \infty
}
$$

\section{Appliquer l'algorithme de Warshall pour calculer $A^*$}

Après avoir adapté l'algorithme fourni, afin qu'il prenne en compte
les chemins de capacité maximum et non les plus courts chemins, on
obtient la matrice $A^*$ suivante.\\

$$
A^* = \bordermatrix{
    & 1 & 2 & 3 & 4 & 5 & 6 & 7 & 8 \cr
  1 & \infty & 12 & 14 & 12 & 12 & 11 & 12 & 11 \cr
  2 & 12 & \infty & 12 & 17 & 15 & 11 & 15 & 11 \cr
  3 & 14 & 12 & \infty & 12 & 12 & 11 & 12 & 11 \cr
  4 & 12 & 17 & 12 & \infty & 15 & 11 & 15 & 11 \cr
  5 & 12 & 15 & 12 & 15 & \infty & 11 & 18 & 11 \cr
  6 & 11 & 11 & 11 & 11 & 11 & \infty & 11 & 15 \cr
  7 & 12 & 15 & 12 & 15 & 18 & 11 & \infty & 11 \cr
  8 & 11 & 11 & 11 & 11 & 11 & 15 & 11 & \infty
}
$$

\section{Graphe de $A^*$}

\begin{tikzpicture}

  \centering

  \foreach \i in {1,...,8} {
    \node[circle,draw,fill=green!20] at ({\i*(360/8)+45}:6cm) (\i) {\i};
    \coordinate (c\i) at ({\i*(360/8)+45}:6cm);
  }

  \newcommand{\link}[4]{
    \draw (#1) -- (#2);
    \coordinate (t) at ($(#2)-(#1)$);
    \node[draw,fill=gray!40,rectangle] at ($(#1)+#4*(t)$) {#3};
  }

  \link{1}{2}{12}{0.5}
  \link{1}{3}{14}{0.35}
  \link{1}{4}{12}{0.5}
  \link{1}{5}{12}{0.4}
  \link{1}{6}{11}{0.5}
  \link{1}{7}{12}{0.35}
  \link{1}{8}{11}{0.5}

  \link{2}{3}{12}{0.5}
  \link{2}{4}{17}{0.35}
  \link{2}{5}{15}{0.5}
  \link{2}{6}{11}{0.2}
  \link{2}{7}{15}{0.5}
  \link{2}{8}{11}{0.46}

  \link{3}{4}{12}{0.5}
  \link{3}{5}{12}{0.35}
  \link{3}{6}{11}{0.5}
  \link{3}{7}{12}{0.35}
  \link{3}{8}{11}{0.5}

  \link{4}{5}{15}{0.5}
  \link{4}{6}{11}{0.2}
  \link{4}{7}{15}{0.5}
  \link{4}{8}{11}{0.35}

  \link{5}{6}{11}{0.5}
  \link{5}{7}{18}{0.35}
  \link{5}{8}{11}{0.5}

  \link{6}{7}{11}{0.5}
  \link{6}{8}{15}{0.35}

  \link{7}{8}{11}{0.5}

\end{tikzpicture}

\section{Appliquer l'algorithme de Dijkstra }

On déroule manuellement l'algorithme de Dijkstra. On utilise ici sa
version améliorée afin de bénéficier d'une liste contenant le
prédecesseur de chaque n\oe ud dans le meilleur parcours. On s'en
servira typiquement pour reconstruire les chemins.

\newpage

\underline{Initialisation}

\begin{align*}
  &T = (1,2,3,4,5,6,7,8) \\
  &\pi = (\infty, 0,0,0,0,0,0,0) \\
  &P = (\varepsilon,\varepsilon,\varepsilon,\varepsilon,\varepsilon,\varepsilon,\varepsilon,\varepsilon)
\end{align*}

\underline{Itération 1}

\begin{align*}
  &i = \mMAX_{\forall j \in T}(\pi_j) = 1\\
  &T = (2,3,4,5,6,7,8)
\end{align*}

\begin{align*}
  &\pi(2) = \mmax(\pi(2), \mmin(\pi(1), A_{12})) = \mmax(0, \mmin(\infty,12)) = 12, &P(2) = 1\\
  &\pi(3) = \mmax(\pi(3), \mmin(\pi(1), A_{13})) = \mmax(0, \mmin(\infty,14)) = 14, &P(3) = 1\\
  &\pi(4) = \mmax(\pi(4), \mmin(\pi(1), A_{14})) = \mmax(0, \mmin(\infty,10)) = 10, &P(4) = 1\\
  &\pi(5) = \mmax(\pi(5), \mmin(\pi(1), A_{15})) = \mmax(0, \mmin(\infty,0)) = 0\\
  &\pi(6) = \mmax(\pi(6), \mmin(\pi(1), A_{16})) = \mmax(0, \mmin(\infty,0)) = 0\\
  &\pi(7) = \mmax(\pi(7), \mmin(\pi(1), A_{17})) = \mmax(0, \mmin(\infty,0)) = 0\\
  &\pi(8) = \mmax(\pi(8), \mmin(\pi(1), A_{18})) = \mmax(0, \mmin(\infty,0)) = 0
\end{align*}

\begin{align*}
  \pi &= (\infty,12,14,10,0,0,0,0)\\
  P &= (\varepsilon, 1, 1, 1, \varepsilon, \varepsilon, \varepsilon, \varepsilon)
\end{align*}

\underline{Itération 2}

\begin{align*}
  &i = \mMAX_{\forall j \in T}(\pi_j) = 3\\
  &T = (2,4,5,6,7,8)
\end{align*}

\begin{align*}
  &\pi(2) = \mmax(\pi(2), \mmin(\pi(3), A_{32})) = \mmax(12, \mmin(14,0)) = 12\\
  &\pi(4) = \mmax(\pi(4), \mmin(\pi(3), A_{34})) = \mmax(10, \mmin(14,5)) = 10\\
  &\pi(5) = \mmax(\pi(5), \mmin(\pi(3), A_{35})) = \mmax(0, \mmin(14,0)) = 0\\
  &\pi(6) = \mmax(\pi(6), \mmin(\pi(3), A_{36})) = \mmax(0, \mmin(14,3)) = 3, &P(6) = 3\\
  &\pi(7) = \mmax(\pi(7), \mmin(\pi(3), A_{37})) = \mmax(0, \mmin(14,0)) = 0\\
  &\pi(8) = \mmax(\pi(8), \mmin(\pi(3), A_{38})) = \mmax(0, \mmin(14,0)) = 0
\end{align*}

\begin{align*}
  \pi &= (\infty,12,14,10,0,3,0,0)\\
  P &= (\varepsilon, 1, 1, 1, \varepsilon, 3, \varepsilon, \varepsilon)
\end{align*}

\underline{Itération 3}

\begin{align*}
  &i = \mMAX_{\forall j \in T}(\pi_j) = 2\\
  &T = (4,5,6,7,8)
\end{align*}

\begin{align*}
  &\pi(4) = \mmax(\pi(4), \mmin(\pi(2), A_{24})) = \mmax(10, \mmin(12,17)) = 12, &P(4) = 2\\
  &\pi(5) = \mmax(\pi(5), \mmin(\pi(2), A_{25})) = \mmax(0, \mmin(12,8)) = 8, &P(5) = 2\\
  &\pi(6) = \mmax(\pi(6), \mmin(\pi(2), A_{26})) = \mmax(3, \mmin(12,0)) = 3\\
  &\pi(7) = \mmax(\pi(7), \mmin(\pi(2), A_{27})) = \mmax(0, \mmin(12,0)) = 0\\
  &\pi(8) = \mmax(\pi(8), \mmin(\pi(2), A_{28})) = \mmax(0, \mmin(12,0)) = 0
\end{align*}

\begin{align*}
  \pi &= (\infty,12,14,12,8,3,0,0)\\
  P &= (\varepsilon, 1, 1, 2, 2, 3, \varepsilon, \varepsilon)
\end{align*}

\underline{Itération 4}

\begin{align*}
  &i = \mMAX_{\forall j \in T}(\pi_j) = 4\\
  &T = (5,6,7,8)
\end{align*}

\begin{align*}
  &\pi(5) = \mmax(\pi(5), \mmin(\pi(4), A_{45})) = \mmax(8, \mmin(12,11)) = 11, &P(5) = 4\\
  &\pi(6) = \mmax(\pi(6), \mmin(\pi(4), A_{46})) = \mmax(3, \mmin(12,6)) = 6, &P(6) = 4\\
  &\pi(7) = \mmax(\pi(7), \mmin(\pi(4), A_{47})) = \mmax(0, \mmin(12,15)) = 12, &P(7) = 4\\
  &\pi(8) = \mmax(\pi(8), \mmin(\pi(4), A_{48})) = \mmax(0, \mmin(12,0)) = 0
\end{align*}

\begin{align*}
  \pi &= (\infty,12,14,12,11,6,12,0)\\
  P &= (\varepsilon, 1, 1, 2, 4, 4, 4, \varepsilon)
\end{align*}

\underline{Itération 5}

\begin{align*}
  &i = \mMAX_{\forall j \in T}(\pi_j) = 7\\
  &T = (5,6,8)
\end{align*}

\begin{align*}
  &\pi(5) = \mmax(\pi(5), \mmin(\pi(7), A_{75})) = \mmax(11, \mmin(12,18)) = 12, &P(5) = 7\\
  &\pi(6) = \mmax(\pi(6), \mmin(\pi(7), A_{76})) = \mmax(6, \mmin(12,4)) = 6\\
  &\pi(8) = \mmax(\pi(8), \mmin(\pi(7), A_{78})) = \mmax(0, \mmin(12,9)) = 9, &P(8) = 7
\end{align*}

\begin{align*}
  \pi &= (\infty,12,14,12,12,6,12,9)\\
  P &= (\varepsilon, 1, 1, 2, 7, 4, 4, 7)
\end{align*}

\underline{Itération 6}

\begin{align*}
  &i = \mMAX_{\forall j \in T}(\pi_j) = 5\\
  &T = (6,8)
\end{align*}

\begin{align*}
  &\pi(6) = \mmax(\pi(6), \mmin(\pi(5), A_{56})) = \mmax(6, \mmin(12,0)) = 6\\
  &\pi(8) = \mmax(\pi(8), \mmin(\pi(5), A_{58})) = \mmax(9, \mmin(12,11)) = 11, &P(8) = 5
\end{align*}

\begin{align*}
  \pi &= (\infty,12,14,12,12,6,12,11)\\
  P &= (\varepsilon, 1, 1, 2, 7, 4, 4, 5)
\end{align*}

\underline{Itération 7}

\begin{align*}
  &i = \mMAX_{\forall j \in T}(\pi_j) = 8\\
  &T = (6)
\end{align*}

\begin{align*}
  &\pi(6) = \mmax(\pi(6), \mmin(\pi(8), A_{86})) = \mmax(6, \mmin(11,15)) = 11, &P(6) = 8\\
\end{align*}

\begin{align*}
  \pi &= (\infty,12,14,12,12,11,12,11)\\
  P &= (\varepsilon, 1, 1, 2, 7, 8, 4, 5)
\end{align*}

\underline{Itération 8}

\begin{align*}
  &i = \mMAX_{\forall j \in T}(\pi_j) = 6\\
  &T = \emptyset
\end{align*}

$T = \emptyset$ alors l'algorithme est arrivé à la fin de son
exécution et on obtient :

\begin{table}[H]

  \centering

  \begin{tabular}{c|cccccccc}
    
    & 1 & 2 & 3 & 4 & 5 & 6 & 7 & 8 \\
    \hline
    $\pi$ & $\infty$ & 12 & 14 & 12 & 12 & 11 & 12 & 11 \\
    P & $\varepsilon$ & 1 & 1 & 2 & 7 & 8 & 4 & 5 \\
  \end{tabular}

\end{table}

Prenons l'exemple du chemin de capacité maximum reliant 1 à 8. On sait
que sa capacité vaut 11 et on peut le reconstruire à l'aide de la
liste $P$ des prédécesseurs. Il s'agit de :

\begin{align*}
  &8 \rightarrow P(8) \rightarrow P(P(8)) \rightarrow \dots \rightarrow 1\\\\
  &8 \rightarrow 5 \rightarrow 7 \rightarrow 4 \rightarrow 2 \rightarrow 1
\end{align*}

\section{Appliquer l'algorithme de Jacobi}

Nous allons maintenant utiliser l'algorithme de Jacobi pour déterminer
les chemins de capacité maximale partant de 1. Les résultats trouvés
devraient être identiques à ceux de l'algorithme de Dijkstra.\\

\underline{Initialisation}

\begin{align*}
  y^0 = b^T = (\infty, 0, 0, 0, 0, 0, 0, 0)
\end{align*}

\underline{Itération 1}

\begin{align*}
  y^1 &= y^0 \otimes A \oplus b^T = \mmax(\mmin(y^0,A),b^T)
\end{align*}

\begin{align*}
  \mmin(y^0,A) &= \mmin((\infty,0,0,0,0,0,0,0),
  \begin{pmatrix}
      \infty & 12 & 14 & 10 & 0 & 0 & 0 & 0 \\
      12 & \infty & 0 & 17 & 8 & 0 & 0 & 0 \\
      14 & 0 & \infty & 5 & 0 & 3 & 0 & 0 \\
      10 & 17 & 5 & \infty & 11 & 6 & 15 & 0 \\
      0 & 8 & 0 & 11 & \infty & 0 & 18 & 11 \\
      0 & 0 & 3 & 6 & 0 & \infty & 4 & 15 \\
      0 & 0 & 0 & 15 & 18 & 4 & \infty & 9 \\
      0 & 0 & 0 & 0 & 11 & 15 & 9 & \infty
  \end{pmatrix})\\
  &= (\infty,12,14,10,0,0,0,0)
\end{align*}

\begin{align*}
  y^1 &= \mmax(\mmin(y^0,A),b^T)\\
  &= \mmax((\infty, 12,14,10,0,0,0,0), (\infty,0,0,0,0,0,0,0))\\
  &= (\infty, 12,14,10,0,0,0,0)
\end{align*}

\underline{Itération 2}

\begin{align*}
  y^2 &= y^1 \otimes A \oplus b^T = \mmax(\mmin(y^1,A),b^T)
\end{align*}

\begin{align*}
  \mmin(y^1,A) &= \mmin((\infty,12,14,10,0,0,0,0),
  \begin{pmatrix}
      \infty & 12 & 14 & 10 & 0 & 0 & 0 & 0 \\
      12 & \infty & 0 & 17 & 8 & 0 & 0 & 0 \\
      14 & 0 & \infty & 5 & 0 & 3 & 0 & 0 \\
      10 & 17 & 5 & \infty & 11 & 6 & 15 & 0 \\
      0 & 8 & 0 & 11 & \infty & 0 & 18 & 11 \\
      0 & 0 & 3 & 6 & 0 & \infty & 4 & 15 \\
      0 & 0 & 0 & 15 & 18 & 4 & \infty & 9 \\
      0 & 0 & 0 & 0 & 11 & 15 & 9 & \infty
  \end{pmatrix})\\
  &= (\infty, 12,14,12,10,6,10,0)
\end{align*}

\begin{align*}
  y^2 &= \mmax(\mmin(y^0,A),b^T)\\
  &= \mmax((\infty, 12,14,12,10,6,10,0), (\infty,0,0,0,0,0,0,0))\\
  &= (\infty, 12,14,12,10,6,10,0)
\end{align*}

\underline{Itération 3}\\

On procède de la même façon pour les itérations suivantes.

\begin{align*}
  y^3 = (\infty,12,14,12,11,10,12,10)
\end{align*}

\underline{Itération 4}\\

\begin{align*}
  y^4 = (\infty,12,14,12,12,10,12,11)
\end{align*}

\underline{Itération 5}\\

\begin{align*}
  y^5 = (\infty,12,14,12,12,11,12,11)
\end{align*}

\underline{Itération 6}\\

\begin{align*}
  y^6 = (\infty,12,14,12,12,11,12,11)
\end{align*}\\

On a $y^5 = y^6$ donc on est arrivé à la fin de l'algorithme. Les
résultats fournis par l'algorithme de Jacobi correspondent à ceux
déterminés par l'algorithme de Dijkstra.

\section{Améliorer l'algorithme de Jacobi}

Afin de pouvoir reconstruire les chemins de capacité maximum à la fin
de l'exécution de l'algorithme de Jacobi, on en propose une nouvelle
version.\\

Le principe est le même que dans l'algorithme de Dijkstra amélioré :
On initialise au début une liste $P$ de prédécesseurs et à chaque
itération on la met à jour en fonction des valeurs ayant changé. Pour
connaître le prédécesseur d'un n\oe ud dont la valeur dans la liste
$y$ vient de changer, il faut se référer à la matrice d'adjacence. Le
prédécesseur est alors le n\oe ud correpondant à la ligne de la
matrice dont la valeur a été absorbée.\\

Par exemple, à la première itération de la question précédente, on
avait $y^0(2) = 0$ et $y^1(2) = 12$, il était donc nécessaire de
changer le prédécesseur de 2. Pour le déterminer, on remarque dans la
matrice d'adjacence que la nouvelle valeur de 2 provient de la
première ligne puisque $y^1(2) = \mmax(\mmin(y^0,A_2),b^T)$ et
$\mmin(y^0,A_2) = \mMAX(\mmin(\infty,12),\mmin(0,\infty),\dots)) =
\mMAX(\mmin(\infty,12))$ et le 12 en question provient de la première
ligne de la matrice. Au final $P(2) = 1$ après la première itération.

\end{document}
